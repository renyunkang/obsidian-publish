<!doctype html><html lang=en><head><script async defer data-website-id=08a754c4-6690-46d7-bb80-8ff93cfa232f src=https://umami.oldwinter.top/umami.js></script><meta charset=utf-8><meta name=description content="#todo
  cni è°ƒç ”
 é˜¿é‡Œ - hybridnet - CNStack ç½‘ç»œæ’ä»¶ï¼šhybridnet çš„è®¾è®¡ä¸å®ç° daocloud - spiderpool SpiderPool - äº‘åŸç”Ÿå®¹å™¨ç½‘ç»œ IPAM æ’ä»¶ calico iptables æ•°æ®é¢    calico iptables æ•°é‡ - èƒ½å¦å…³é—­ - ebpf"><title>ğŸŒ¿çŸ¥è¯†èŠ±å›­ğŸŒ¸</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://www.ryken.cloud//icon.png><link href=https://www.ryken.cloud/styles.b3e1e36b0403ac565c9392b3e23ef3b6.min.css rel=stylesheet><link href=https://www.ryken.cloud/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://www.ryken.cloud/js/darkmode.66c3ed4615b59e04fa897375e67b0fe2.min.js></script>
<script src=https://www.ryken.cloud/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://www.ryken.cloud/js/popover.abe6a51cc7138c5dff00f151dd627ad1.min.js></script>
<script src=https://www.ryken.cloud/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://www.ryken.cloud/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://www.ryken.cloud/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://www.ryken.cloud/",fetchData=Promise.all([fetch("https://www.ryken.cloud/indices/linkIndex.1dd17b37c5dfdab8739bcec669a1d13c.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://www.ryken.cloud/indices/contentIndex.95b7f4a7cf7b26c0f453e9419530fd00.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addCollapsibleCallouts(),initPopover("https://www.ryken.cloud",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://www.ryken.cloud",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script>window.Million={navigate:e=>window.location.href=e,prefetch:()=>{}},window.addEventListener("DOMContentLoaded",()=>{init(),render()})</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-11MD77L81V"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-11MD77L81V",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=search placeholder=æ”¯æŒæ ‡é¢˜åŠå…¨æ–‡æœç´¢...><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://www.ryken.cloud/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://www.ryken.cloud/>ğŸŒ¿çŸ¥è¯†èŠ±å›­ğŸŒ¸</a></h1><div class=spacer></div><div id=search-icon><p>search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>æœ€è¿‘ç¼–è¾‘äº
Apr 8, 2023</p><ul class=tags></ul><aside class=mainTOC><details><summary>ç›®å½•</summary><nav id=TableOfContents><ol><li><ol><li></li></ol></li><li><a href=#openelb>openelb</a></li><li><a href=#network>network</a></li></ol></nav></details></aside><p>#todo</p><ul><li><p><input disabled type=checkbox> cni è°ƒç ”</p><ul><li><input disabled type=checkbox> é˜¿é‡Œ - hybridnet -
<a href=https://mp.weixin.qq.com/s/d_7GdrIHgPEVESXd6Rn1dA rel=noopener>CNStack ç½‘ç»œæ’ä»¶ï¼šhybridnet çš„è®¾è®¡ä¸å®ç°</a></li><li><input disabled type=checkbox> daocloud - spiderpool
<a href=https://mp.weixin.qq.com/s/r6YiuUBGD2KmmMOxl26X6A rel=noopener>SpiderPool - äº‘åŸç”Ÿå®¹å™¨ç½‘ç»œ IPAM æ’ä»¶</a></li><li><input disabled type=checkbox> calico iptables æ•°æ®é¢</li></ul></li><li><p><input disabled type=checkbox> calico iptables æ•°é‡ - èƒ½å¦å…³é—­ - ebpf</p></li><li><p><input disabled type=checkbox> calico ç›‘æ§æ–‡æ¡£ - calico æŠ€æœ¯ blogã€calico cloud</p></li><li><p><input disabled type=checkbox> å»ºä¿¡é‡‘ç§‘ openelb éœ€æ±‚ã€‚</p></li><li><p><input disabled type=checkbox> <strong>kse 4.0 å¼€å‘</strong></p></li><li><p><input disabled type=checkbox> kube-ovn ovnlb äº¤ä»˜ç¯å¢ƒ svc ä¸é€š</p></li><li><p><input disabled type=checkbox> coredns åŸç† - æ’ä»¶</p></li><li><p><input disabled type=checkbox> ip rule + iptables mark</p><ul><li><input disabled type=checkbox>
<a href=https://man7.org/linux/man-pages/man8/ip-rule.8.html rel=noopener>ip-rule (man7.org)</a></li><li><input disabled type=checkbox>
<a href=https://www.cnblogs.com/wanstack/p/7728785.html rel=noopener>Linuxç³»åˆ—â€”ç­–ç•¥è·¯ç”±ã€ip ruleã€ip route</a></li><li><input disabled type=checkbox>
<a href=https://www.jianshu.com/p/7da4d1606f6a rel=noopener>iptables markæ ‡è®°</a></li></ul></li><li><p><input checked disabled type=checkbox> 1. calico iaas bird æ­å»º tor + æ¨¡æ‹Ÿé™é€Ÿ</p><ul><li><input checked disabled type=checkbox> bgp æŠ¥æ–‡æŠ“å–</li><li><input checked disabled type=checkbox> containerlab</li></ul></li><li><p><input checked disabled type=checkbox> ippool æµ‹è¯•</p><ul><li><input checked disabled type=checkbox> ippool bug
<a href=https://github.com/kubesphere/issues/issues/897 rel=noopener>ã€ippoolã€‘ippoolå—å¤§å°çš„èŒƒå›´åº”ä¸º â€œ[æ©ç ï¼Œ32]â€ Â· Issue #897 Â· kubesphere/issues (github.com)</a></li><li><input disabled type=checkbox> bgp overlay æ¨¡å¼çš„æè¿° - ä¿®æ”¹</li><li><input checked disabled type=checkbox> calico è¿ç»­åˆ›å»ºå¤šä¸ª ippool tunnel ä¼šè¢«åˆ†é… - bug 3.23.2?</li></ul></li><li><p><input disabled type=checkbox> <strong>kind æ­å»ºçš„é›†ç¾¤ - logs + exec</strong></p></li><li><p><input checked disabled type=checkbox> ks ä¸ openelb çš„å®‰è£…é›†æˆçš„é—®é¢˜
<a href=https://github.com/kubesphere/issues/issues/577 rel=noopener>åœ¨é¡¹ç›®è¯¦æƒ…é¡µé¢ï¼Œæ¥å£ã€configurations.springcloud.kubesphere.ioã€‘404 Â· Issue #577 Â· kubesphere/issues (github.com)</a></p><ul><li><input disabled type=checkbox> æˆ–è®¸éœ€è¦æä¾›æ–‡æ¡£ - å¸è½½ä¹‹åæ‰‹åŠ¨åˆ é™¤ crd</li><li><input disabled type=checkbox> openelb ç”±æ‰‹åŠ¨å®‰è£…æˆ–è€…åº”ç”¨å•†åº—å®‰è£…</li></ul></li><li><p><input checked disabled type=checkbox> tor ä¸ node åš rr èŠ‚ç‚¹çš„ä¸åŒ</p></li><li><p><input checked disabled type=checkbox> 2. <strong>kse calico - libcalico ä¾èµ–</strong></p><ul><li><input checked disabled type=checkbox> calico å°†api ç‰ˆæœ¬å†™æ­»ä¸”æ²¡æœ‰calico liencese</li><li><input checked disabled type=checkbox> init libcalico-go</li></ul></li><li><p><input checked disabled type=checkbox> <strong>ippool é…ç½®ç»†åŒ–å¼€å‘</strong> <a href=/%E4%B8%B4%E6%97%B6 rel=noopener class=internal-link data-src=/%E4%B8%B4%E6%97%B6>ä¸´æ—¶</a></p><ul><li><input checked disabled type=checkbox> ippool å ç”¨ å°è£…åˆ†é…æ¥å£ ip ä¹‹åï¼Œæ— æ³•æ“ä½œ</li></ul></li><li><p><input checked disabled type=checkbox> <strong>åä¸ºé•œåƒé—®é¢˜ - isdp cve</strong></p></li><li><p><input checked disabled type=checkbox> calico ä¸¢æ‰éå¿…è¦è·¯ç”± - Calicoèƒ½å¦è¿‡æ»¤è‡ªå·±æƒ³è¦çš„è·¯ç”±</p></li><li><p><input checked disabled type=checkbox> calico å›ç¯è·¯ç”±</p></li><li><p><input checked disabled type=checkbox> <strong>ks å‘é«˜ç‰ˆæœ¬ k8s å…¼å®¹é—®é¢˜</strong></p></li><li><p><input disabled type=checkbox> calico ç›‘æ§ <a href=/%E6%A8%A1%E5%9D%97%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AE rel=noopener class=internal-link data-src=/%E6%A8%A1%E5%9D%97%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AE>æ¨¡å—ä»¥åŠé…ç½®</a> <a href=/%E7%9B%91%E6%8E%A7%E6%96%87%E6%A1%A3 rel=noopener class=internal-link data-src=/%E7%9B%91%E6%8E%A7%E6%96%87%E6%A1%A3>ç›‘æ§æ–‡æ¡£</a> <a href=/grafana-%E5%8F%AF%E8%A7%86%E5%8C%96 rel=noopener class=internal-link data-src=/grafana-%E5%8F%AF%E8%A7%86%E5%8C%96>grafana å¯è§†åŒ–</a></p></li><li><p><input disabled type=checkbox> calico ä¸åŒç½‘ç»œç¯å¢ƒçš„å»ºè®® <strong>æ­å»ºç¯å¢ƒéªŒè¯</strong>
CalicoåæœŸå»ºè®¾ä¸­ï¼Œæ¶‰åŠåˆ° cidrã€blocksizeã€RRã€TORç­‰å½±å“è·¯ç”±æƒ…å†µï¼Œé¿å…å‡ºç°nodeä¹‹é—´è·¯ç”±ä¸é€šï¼Œæä¾›å»ºè®®
ä¹‹å‰å‡ºç° blocksize é—®é¢˜çš„ç½‘ç»œç¯å¢ƒæ˜¯æ€ä¹ˆæ ·çš„ - <strong>æ€€ç–‘ calico rr å»ºç«‹é…ç½®ç¼ºå¤±</strong>
rr æ¨¡å¼
<a href=https://projectcalico.docs.tigera.io/reference/architecture/design/l3-interconnect-fabric#the-as-per-rack-model rel=noopener>Calico over IP fabrics (tigera.io)</a></p></li><li><p><input disabled type=checkbox> å…‰å¤§ bgp é—®é¢˜</p><ul><li><input disabled type=checkbox> åœ¨è£¸é‡‘å±ç¯å¢ƒé‡Œé¢ï¼ŒCalicoçš„BGPä¸ºä»€ä¹ˆä¼šæ–­æ‰ï¼ŸåŸå› æ˜¯ä»€ä¹ˆï¼ŸÂ ç›‘æ§æ€ä¹ˆåšçš„ï¼Ÿ - <strong>æ—¥å¿—</strong></li><li><input disabled type=checkbox> CalicoÂ BGPçš„æ—¶é—´å‚æ•°æ˜¯å¦éœ€è¦æ›´æ”¹? - <strong>confd æä¾›çš„æ¨¡æ¿ä¸­æ²¡æœ‰å¯¹åº”æ—¶é—´å‚æ•°çš„å­—æ®µ</strong>
äº¤æ¢æœº bgp çš„å„ä¸ªå®šæ—¶å™¨ï¼Œupdate timer</li><li><input disabled type=checkbox> nodeèŠ‚ç‚¹æ˜¯å¦å¯ä»¥åšè·¯ç”±èšåˆï¼Œä»5kå¤šæ¡èƒ½èåˆåˆ°1æ¡æˆ–è€…å‡ æ¡
<strong>å»ºè®®è¿˜æ˜¯åœ¨äº¤æ¢æœºä¾§åšè·¯ç”±èšåˆ</strong> bird æš‚ä¸æ”¯æŒè·¯ç”±èšåˆ
<a href="https://bird.network.cz/?get_doc&v=20&f=bird-7.html#ss7.2" rel=noopener>The BIRD Internet Routing Daemon Project (network.cz)</a>
äº¤æ¢æœºå‘å¸ƒçš„è·¯ç”±æ˜¯ä»€ä¹ˆæ ·çš„</li></ul></li></ul><p>åŒäº¤æ¢æœºå»ºç«‹BGPçš„è·¯ç”±å‘å¸ƒæƒ…å†µ - RR /TORæ¨¡å¼
1.Â Â Calicoåˆå§‹åŒ–æ—¶ï¼Œä¼šå‘é€å“ªäº›BGPæŠ¥æ–‡ã€‚BGPæŠ¥æ–‡é‡Œé¢å¤§è‡´åŒ…å«å†…å®¹
2.Â Â åˆ›å»ºPODæ—¶ï¼Œä¼šå‘é€å“ªäº›BGPæŠ¥æ–‡<br>3.Â Â åˆ é™¤PODæ—¶ï¼Œä¼šå‘é€å“ªäº›BGPæŠ¥æ–‡<br>4.Â Â æ²¡æœ‰æ“ä½œæ—¶ï¼ŒBGPä¼šå‘é€å“ªäº›æŠ¥æ–‡
5.Â Â nodeé‡å¯æ—¶ï¼Œnodeä¸Šæœ‰podï¼ŒæŠ¥æ–‡æ˜¯æ€ä¹ˆå‘é€çš„ï¼Ÿ<br>6.Â Â å…¶ä»–æƒ…å†µï¼Œä¼šå¯¼è‡´BGPæœ‰æŠ¥æ–‡å‘é€<br>7.Â Â æ ¹æ®ä¸Šè¿°æ¡ä»¶ï¼Œå“ªäº›è¡Œä¸ºéœ€è¦è®¾ç½®ç›‘æ§ã€‚
8. Â Â æœ¬åœ°åŒæ­¥æ¥æ”¶å¤–éƒ¨ bgp è·¯ç”±ï¼Œå¤„ç†å¤§è‡´è¿‡ç¨‹
<a href=/Calico-Full-Mesh-BGP-%E6%8A%A5%E6%96%87 rel=noopener class=internal-link data-src=/Calico-Full-Mesh-BGP-%E6%8A%A5%E6%96%87>Calico Full-Mesh BGP æŠ¥æ–‡</a></p><ul><li><p><input checked disabled type=checkbox> calico æ—¥å¿— - calico é‡å¯ - ç³»ç»Ÿæ—¥å¿—</p></li><li><p><input checked disabled type=checkbox> kube-ovn å®‰è£…åè·¨èŠ‚ç‚¹æ— æ³•é€šä¿¡
geneve å°è£…çš„é—®é¢˜ï¼Œä¿®æ”¹ä¸º vxlan æš‚æ—¶è§£å†³
ks é›†æˆ kube-ovn æ—¶ï¼Œè€ƒè™‘ vxlan æ¨¡å¼ä¸‹ç½‘ç»œéš”ç¦»çš„æ˜¯å¦å¯ç”¨</p></li><li><p><input checked disabled type=checkbox> åä¸º æ¬§æ‹‰ arp é—®é¢˜
æ‰‹åŠ¨åˆ›å»º veth-pair è®¾å¤‡ä¹Ÿå­˜åœ¨é—®é¢˜
arp incomplete æ—¶é—´è¾ƒé•¿ <a href=/arp-proxy rel=noopener class=internal-link data-src=/arp-proxy>arp proxy</a></p></li><li><p><input checked disabled type=checkbox> å…‰å¤§åŒæ ˆçš„éœ€æ±‚</p></li><li><p><input disabled type=checkbox> 1. calico iaas bird æ­å»º tor + æ¨¡æ‹Ÿé™é€Ÿ</p><ul><li><input disabled type=checkbox> bgp æŠ¥æ–‡æŠ“å–</li><li><input disabled type=checkbox> containerlab</li></ul></li><li><p><input disabled type=checkbox> 2. <strong>kse calico - libcalico ä¾èµ–</strong></p></li><li><p><input disabled type=checkbox> <strong>ks å‘é«˜ç‰ˆæœ¬ k8s å…¼å®¹é—®é¢˜</strong></p></li><li><p><input disabled type=checkbox> <strong>ippool é…ç½®ç»†åŒ–å¼€å‘</strong></p><ul><li><input disabled type=checkbox> ippool å ç”¨ å°è£…åˆ†é…æ¥å£ ip ä¹‹åï¼Œæ— æ³•æ“ä½œ</li></ul></li><li><p><input disabled type=checkbox> <strong>åä¸ºé•œåƒé—®é¢˜ - isdp cve</strong></p></li><li><p><input disabled type=checkbox> calico iptables æ•°é‡ - èƒ½å¦å…³é—­</p></li><li><p><input disabled type=checkbox> calico ä¸¢æ‰éå¿…è¦è·¯ç”±</p></li><li><p><input disabled type=checkbox> calico å›ç¯è·¯ç”±</p></li><li><p><input disabled type=checkbox> <strong>kse 4.0 å¼€å‘</strong></p></li><li><p><input disabled type=checkbox> ks ä¸ openelb çš„å®‰è£…é›†æˆçš„é—®é¢˜
<a href=https://github.com/kubesphere/issues/issues/577 rel=noopener>åœ¨é¡¹ç›®è¯¦æƒ…é¡µé¢ï¼Œæ¥å£ã€configurations.springcloud.kubesphere.ioã€‘404 Â· Issue #577 Â· kubesphere/issues (github.com)</a></p></li><li><p><input checked disabled type=checkbox> ipv6 ç¯å¢ƒ</p></li><li><p><input disabled type=checkbox> ä¸­ç§»ç‰©è”ç½‘ &mdash; ç½‘ç»œç­–ç•¥æ–°éœ€æ±‚
<a href=https://tenant.quanxiangyun.com/qingcloud/manage/tickets/210404 rel=noopener>å…¨è±¡äº‘æœ | å‚å•†ç®¡ç†åå° (quanxiangyun.com)</a></p></li><li><p><input disabled type=checkbox></p></li><li><p><input disabled type=checkbox> è´Ÿè½½ä½¿ç”¨å¤šä¸ª calico ippool - ç•Œé¢ä¸Šæ”¯æŒçš„å¼€å‘</p></li><li><p><input disabled type=checkbox> ks 3.4 å¼€å‘ - é›†æˆ hostport - ks-installer é€‰è£…é¡¹</p><ul><li><input disabled type=checkbox> webhook çš„å®‰è£… - cert-manager <a href=/webhook rel=noopener class=internal-link data-src=/webhook>webhook</a></li></ul></li><li><p><input checked disabled type=checkbox> ippool å€Ÿç”¨ip - å€Ÿç”¨ ip ï¼Œè·¯ç”±é€š</p></li><li><p><input checked disabled type=checkbox> calico bgp å­˜æ´»æ¢é’ˆåŸç†</p><ul><li>felix http è¯·æ±‚ localhost:9099/liveness</li><li>sv status /etc/service/enabled/bird</li><li>sv status /etc/service/enabled/confd
<img src=https://images.ryken.cloud/2023/02/upgit_20230220_1676873970.png width=auto alt=upgit_20230220_1676873970.png></li></ul></li><li><p><input checked disabled type=checkbox> ks 3.4 å¼€å‘ - ippool æ·»åŠ é«˜çº§é…ç½®é¡¹ï¼šipipmodeã€blockSizeã€disabledï¼Œæ–°å»º/åˆ é™¤æ—¶æ·»åŠ æç¤ºä¿¡æ¯</p></li><li><p>åˆ›å»ºï¼šipipmodeã€blockSizeï¼ŒæœªæŒ‡å®šæ—¶ä½¿ç”¨é»˜è®¤çš„</p></li><li><p>ä¿®æ”¹ï¼šipipmodeã€disabled</p></li><li><p>å¯¹äº blocksize åªèƒ½åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼Œä¸æ”¯æŒä¿®æ”¹</p></li><li><p>å¯¹äº ipipmodeã€disable å¯ä»¥åœ¨åˆ›å»ºæ—¶æŒ‡å®šä¹Ÿå¯ä»¥åŠ¨æ€ä¿®æ”¹</p></li><li><p>disable çš„ ippool åœ¨åˆ›å»ºè´Ÿè½½æ—¶ä¸èƒ½æŒ‡å®šï¼Œç¦ç”¨æ—¶æ˜¾ç¤ºæç¤ºä¿¡æ¯</p></li><li><p>deploy è¦æ”¯æŒä¿®æ”¹ ippool
<img src=https://images.ryken.cloud/2023/01/upgit_20230111_1673427998.png width=auto alt=upgit_20230111_1673427998.png></p></li></ul><p><img src=https://images.ryken.cloud/2023/02/upgit_20230202_1675319026.png width=auto alt=upgit_20230202_1675319026.png></p><p><img src=https://images.ryken.cloud/2023/02/upgit_20230202_1675319131.png width=auto alt=upgit_20230202_1675319131.png></p><table><thead><tr><th>æƒ…å†µ</th><th>æƒ…æ™¯</th><th>é¢„æœŸçš„æ•ˆæœ</th></tr></thead><tbody><tr><td>è®¾ç½® vxlan</td><td>calico ä½¿ç”¨ ipip</td><td>vxlan</td></tr><tr><td></td><td>calico ä½¿ç”¨ vxlan</td><td>vxlan</td></tr><tr><td></td><td>calico å‡ä¸ä½¿ç”¨</td><td>vxlan</td></tr><tr><td>è®¾ç½® ipip</td><td>calico ä½¿ç”¨ ipip</td><td>ipip</td></tr><tr><td></td><td>calico ä½¿ç”¨ vxlan</td><td>ipip</td></tr><tr><td></td><td>calico å‡ä¸ä½¿ç”¨</td><td>ipip</td></tr><tr><td>è®¾ç½® vxlan + ipip</td><td></td><td>å†²çª</td></tr><tr><td>éƒ½ä¸è®¾ç½®</td><td>calico ä½¿ç”¨ vxlan</td><td>vxlan</td></tr><tr><td></td><td>calico ä½¿ç”¨ ipip</td><td>ipip</td></tr><tr><td></td><td>calico å‡ä¸ä½¿ç”¨</td><td>ä¸ä½¿ç”¨</td></tr><tr><td></td><td>calico å‡é…ç½®</td><td>ipip</td></tr></tbody></table><ul><li><input disabled type=checkbox></li><li><input disabled type=checkbox> openelb svc externalTrafficPolicy
metallb ä¹Ÿå­˜åœ¨é—®é¢˜
ip share</li><li><input disabled type=checkbox> openelb bgp ä¸ calico å†²çªæ–‡æ¡£</li><li><input disabled type=checkbox> ks 3.4 åŠŸèƒ½å¼€å‘</li><li><input disabled type=checkbox> spiderpool ipam å·¥å…·</li><li><a href=https://mp.weixin.qq.com/s/r6YiuUBGD2KmmMOxl26X6A rel=noopener>SpiderPool - äº‘åŸç”Ÿå®¹å™¨ç½‘ç»œ IPAM æ’ä»¶ (qq.com)</a></li><li><input disabled type=checkbox></li><li><input disabled type=checkbox> rr mode document ==> kubekey</li><li><input disabled type=checkbox> ä¸åŒæ•°é‡ pod ä¸‹çš„æ—¶å»¶</li><li><input disabled type=checkbox> æµ·å…‰ ebpf nodeport</li><li><input disabled type=checkbox> calico æ—¥å¿— - æ€ä¹ˆå¯¼å‡ºã€æé«˜æ—¥å¿—ç­‰çº§ã€æ€ä¹ˆç­›é€‰çš„çœ‹æ—¥å¿—ã€é”™è¯¯æ—¥å¿—</li><li><input disabled type=checkbox> containerlab - ç»„ç½‘æµ‹è¯•</li><li><a href=https://github.com/srl-labs/containerlab rel=noopener>srl-labs/containerlab: containerlab enables container-based networking labs (github.com)</a></li><li><input disabled type=checkbox></li><li><input disabled type=checkbox></li><li><input disabled type=checkbox> openelb bgp ä¸ calico å†²çªæ–‡æ¡£ &ndash; å¯ä»¥åˆ†é…ï¼Œæ— æ³•å›æ”¶ï¼Ÿ
labels:
openelb.kubesphere.io/cni: calico
Bgp not ready, please config bgpconf/bgppeer
<img src=https://images.ryken.cloud/2023/01/upgit_20230109_1673249598.png width=auto alt=upgit_20230109_1673249598.png></li></ul><p><img src=https://images.ryken.cloud/2022/12/upgit_20221227_1672121633.png width=auto alt=upgit_20221227_1672121633.png></p><p><img src=https://images.ryken.cloud/2022/12/upgit_20221229_1672297418.png width=auto alt=upgit_20221229_1672297418.png></p><a href=#å…‰å¤§åŒå‘¨åŒæ­¥è®¡åˆ’><h4 id=å…‰å¤§åŒå‘¨åŒæ­¥è®¡åˆ’><span class=hanchor arialabel=Anchor># </span>å…‰å¤§åŒå‘¨åŒæ­¥è®¡åˆ’</h4></a><ol><li>åŠŸèƒ½éœ€æ±‚<table><thead><tr><th>éœ€æ±‚/åŠŸèƒ½</th><th>é¢„è®¡å¼€å‘æ—¶é—´</th><th>ç‰ˆæœ¬</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>ui ä¸Š calico å‚æ•°é…ç½®( ipipmodeã€blockSizeã€disabled)</td><td>ä¸€å‘¨</td><td>3.4</td><td>-</td></tr><tr><td>calico ç½‘ç»œç›‘æ§</td><td>-</td><td></td><td>è°ƒç ”ä¸­</td></tr><tr><td>calico è¿è¥æ–‡æ¡£å®Œå–„</td><td>ä¸€å‘¨</td><td>-</td><td>å®Œæˆ</td></tr></tbody></table></li><li>æ€§èƒ½éœ€æ±‚</li></ol><ul><li>æµ·å…‰æœåŠ¡å™¨ï¼Œcalico-ebpf nodeport æ’æŸ¥</li><li>bgp å•çº¿ç¨‹å¸¦å®½</li><li>ebpf å•çº¿ç¨‹å¸¦å®½</li><li>å»¶æ—¶çš„æå‡ç©ºé—´</li></ul><p>ç ”å‘è®¡åˆ’ï¼š</p><ul><li>2022.12åº•ï¼šæäº¤è¿è¥æ–‡æ¡£</li><li>2023.1æœˆ - 2023.1æœˆåº•ï¼šè°ƒç ”ç½‘ç»œç›‘æ§ï¼Œè®¨è®ºç›¸å…³æ–¹æ¡ˆ</li><li>2023.2æœˆå‚ä¸ ks 3.4 å¼€å‘ï¼šå¼€å‘ ui calico å‚æ•°é…ç½®</li><li>2023.3æœˆï¼šæ·±ç©¶æ€§èƒ½é—®é¢˜ä»¥åŠæå‡ç©ºé—´</li></ul><a href=#openelb><h2 id=openelb><span class=hanchor arialabel=Anchor># </span>openelb</h2></a><p>svc æŒ‡å®šæ—¶ï¼Œæ³¨è§£çš„æ•°é‡
vip å¯åŠ¨çš„æ—¶æœº
helm chart &ndash; æµ‹è¯•
ç¤¾åŒºç”¨æˆ·å›¾ç‰‡ - docs
openelb å¹´å®¡ï¼š
<a href=https://github.com/cncf/toc/pull/942/files rel=noopener>MetalLB 2022 Annual Review by fedepaol Â· Pull Request #942 Â· cncf/toc (github.com)</a>
svc webhook
calico + openelb -bgp
deploy securityContext
å¤šç§Ÿæˆ·ï¼Ÿ
helm å¸è½½ keepalived ä»ç„¶åœ¨</p><p>console + server
æ”¹ä¸€ä¸‹å›¾æ ‡
æ—¥å¿—ç­‰çº§</p><ol><li>æ²¡æœ‰è®¾ç½®é»˜è®¤ eip</li><li>å¯¹äºå¡«å†™ç½‘å¡æ—¶çš„æç¤ºä¿¡æ¯</li><li>bgpconf - name</li><li>ip è®¾ç½®æ®µæ—¶é”™è¯¯ä¿¡æ¯æç¤ºé”™è¯¯ï¼Œå¡«å†™å®Œæˆæ—¶æœªæ¶ˆå¤±</li><li>æ·»åŠ  respone msg + code</li><li>console github issueã€pr æ¨¡æ¿</li><li>http è¯·æ±‚æ—¥å¿—</li></ol><p><img src=https://images.ryken.cloud/2022/12/upgit_20221229_1672300989.png width=auto alt=upgit_20221229_1672300989.png></p><p>æ¶æ„è°ƒæ•´
speaker - daemonset
keepalived - ds
controller - deploy
apiserver - deploy
console - deploy</p><a href=#network><h2 id=network><span class=hanchor arialabel=Anchor># </span>network</h2></a><p>openstack network
dhcp æœåŠ¡
vm kubevirt macvtap</p><p>è®¾ç½®çš„ eip pool ä¸èƒ½å’Œ pod cidr å’Œ service cidr å†²çªï¼Œopenelb ä¼šä½¿ç”¨æŒ‡å®šçš„ eip ç»™ service åˆ†é… external ipï¼Œåˆ†é…å®Œæˆä¹‹åä½¿ç”¨ bgp å» å®£å‘Šè·¯ç”±</p><p>bgp routeID æ˜¯ä¸€ä¸ªç”¨äºæ ‡è¯†çš„ IDï¼Œåœ¨ç½‘ç»œä¸­å”¯ä¸€å°±å¯ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œè®¾ç½®äº† openelb-manager è°ƒåº¦åˆ°èŠ‚ç‚¹çš„ip</p><p><a href=https://github.com/kubesphere/ks-installer/blob/master/scripts/kubesphere-delete.sh rel=noopener>ks-installer/kubesphere-delete.sh at master Â· kubesphere/ks-installer (github.com)</a>
kubectl patch customresourcedefinition.apiextensions.k8s.io &ldquo;fluentbits.logging.kubesphere.io&rdquo; -p &lsquo;{&ldquo;metadata&rdquo;:{&ldquo;finalizers&rdquo;:[]}}&rsquo; &ndash;type=merge
kubectl patch customresourcedefinition.apiextensions.k8s.io &ldquo;ippools.network.kubesphere.io&rdquo; -p &lsquo;{&ldquo;metadata&rdquo;:{&ldquo;finalizers&rdquo;:[]}}&rsquo; &ndash;type=merge</p><p><img src=https://images.ryken.cloud/2022/11/upgit_20221118_1668754503.png width=auto alt=upgit_20221118_1668754503.png></p><p>http://172.31.50.2:30880/vnc?host=172.31.50.2&port=30880&path=apis/subresources.kubevirt.io/v1alpha3/namespaces/la/virtualmachineinstances/i-z2vjj7ir/vnc&autoconnect=true&resize=remote</p><table><thead><tr><th>éœ€æ±‚/åŠŸèƒ½</th><th>é¢„è®¡å¼€å‘æ—¶é—´</th><th>ç‰ˆæœ¬</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>ä¼ä¸šç©ºé—´ç½‘ç»œéš”ç¦»é™åˆ¶å‡ºç«™æµé‡</td><td>ä¸€å‘¨</td><td>3.4</td><td>-</td></tr><tr><td>ui ä¸Š calico å‚æ•°é…ç½®( ipipmodeã€blockSizeã€disabled)</td><td>ä¸€å‘¨</td><td>3.4</td><td>-</td></tr><tr><td>calico ç½‘ç»œç›‘æ§</td><td>-</td><td></td><td>è°ƒç ”ä¸­</td></tr><tr><td>nodeport ç«¯å£é¢„ç•™</td><td></td><td>4.x</td><td>è®¾è®¡ä¸­</td></tr><tr><td>é›†æˆ kube-ovn</td><td>ä¸€ä¸ªæœˆ</td><td>4.x</td><td>è®¾è®¡ä¸­</td></tr></tbody></table></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>åå‘é“¾æ¥</h3><ul class=backlinks><li>æœªå‘ç°åå‘é“¾æ¥</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>å†…éƒ¨é“¾æ¥å…³ç³»å›¾</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://www.ryken.cloud/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><hr><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><script src=alittlejs/md5.min.js></script><div id=gitalk-container></div><script>var gitalk=new Gitalk({clientID:"d21f4afcd185c95004e0",clientSecret:"8f1f442abf93a76461783af21c544717da9fc7b3",repo:"obsidian-publish",owner:"renyunkang",admin:["renyunkang"],id:location.href,distractionFreeMode:!1});gitalk.render("gitalk-container")</script><center><script>var caution=!1,now,visits;function setCookie(e,t,n,s,o,a){var i=e+"="+escape(t)+(n?"; expires="+n.toGMTString():"")+(s?"; path="+s:"")+(o?"; domain="+o:"")+(a?"; secure":"");!caution||(e+"="+escape(t)).length<=4e3?document.cookie=i:confirm("Cookie exceeds 4KB and will be cut!")&&(document.cookie=i)}function getCookie(s){var e=s+"=",n,t=document.cookie.indexOf(e);return t==-1?null:(n=document.cookie.indexOf(";",t+e.length),n==-1&&(n=document.cookie.length),unescape(document.cookie.substring(t+e.length,n)))}function deleteCookie(e,t,n){getCookie(e)&&(document.cookie=e+"="+(t?"; path="+t:"")+(n?"; domain="+n:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT")}function fixDate(e){var n=new Date(0),t=n.getTime();t>0&&e.setTime(e.getTime()-t)}now=new Date,fixDate(now),now.setTime(now.getTime()+730*24*60*60*1e3),visits=getCookie("counter"),visits?visits=parseInt(visits)+1:visits=1,setCookie("counter",visits,now),document.write("<font size=2>ğŸ‘‹è®¿é—®é‡ï¼š"+visits+"")</script></center></div></body></html>